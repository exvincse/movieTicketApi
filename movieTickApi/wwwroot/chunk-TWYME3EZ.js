import{a as ee}from"./chunk-W6NNRHFM.js";import{a as T}from"./chunk-7ZDJJMAR.js";import"./chunk-22DMWHJU.js";import{b,c as f,d as P,e as B,h as x,j as R,o as I,p as A,q as V}from"./chunk-3LHWI2W3.js";import{a as E}from"./chunk-XSWKDS7Z.js";import{a as W}from"./chunk-WWFXL6JD.js";import"./chunk-2F6OI5QL.js";import{a as Y}from"./chunk-AN255T3T.js";import{a as J,b as K,e as Q,h as X}from"./chunk-FBP2EEXM.js";import{g as h,l as L}from"./chunk-Q7SBYYKA.js";import{a as k}from"./chunk-AN7I7KN4.js";import{c as $}from"./chunk-AKLULRCC.js";import"./chunk-4QTMHVTB.js";import{$a as n,Ab as _,Ac as Z,Bb as p,Ec as S,Jb as m,Rb as F,Tb as z,ab as l,ma as w,nb as d,q as O,qb as o,rb as g,sb as s,tb as a,ub as u,vb as v,wa as G,wb as C,xa as j,xc as y,yb as H,yc as q,zc as U}from"./chunk-K24PMR7C.js";import{g as M}from"./chunk-TSRGIXR5.js";function le(t,i){t&1&&(s(0,"div",17),m(1," \u8ACB\u8F38\u5165\u5BC6\u78BC "),a())}function pe(t,i){t&1&&(s(0,"div",17),m(1," \u5BC6\u78BC\u9577\u5EA6\u9700\u5927\u65BC8\u78BC "),a())}function ce(t,i){t&1&&(s(0,"div",17),m(1," \u78BA\u8A8D\u5BC6\u78BC\u4E0D\u4E00\u81F4 "),a())}function de(t,i){if(t&1&&(v(0),d(1,le,2,0,"div",16)(2,pe,2,0,"div",16)(3,ce,2,0,"div",16),C()),t&2){let e=p();n(),o("ngIf",e.registerForm.controls.password.hasError("required")),n(),o("ngIf",e.registerForm.controls.password.hasError("minlength")),n(),o("ngIf",e.registerForm.controls.password.hasError("passwordNotMatch"))}}function ue(t,i){t&1&&(s(0,"div",17),m(1," \u8ACB\u8F38\u5165\u65B0\u5BC6\u78BC "),a())}function fe(t,i){t&1&&(s(0,"div",17),m(1," \u5BC6\u78BC\u9577\u5EA6\u9700\u5927\u65BC8\u78BC "),a())}function _e(t,i){t&1&&(s(0,"div",17),m(1," \u78BA\u8A8D\u5BC6\u78BC\u4E0D\u4E00\u81F4 "),a())}function ge(t,i){if(t&1&&(v(0),d(1,ue,2,0,"div",16)(2,fe,2,0,"div",16)(3,_e,2,0,"div",16),C()),t&2){let e=p();n(),o("ngIf",e.registerForm.controls.checkPassword.hasError("required")),n(),o("ngIf",e.registerForm.controls.checkPassword.hasError("minlength")),n(),o("ngIf",e.registerForm.controls.checkPassword.hasError("passwordNotMatch"))}}var D=class t{constructor(i,e,r,c,N){this.fb=i;this.formValidatorService=e;this.router=r;this.userRepositoryService=c;this.sweetAlertService=N;this.registerForm=this.fb.group({password:["",[f.required,f.minLength(8)]],checkPassword:["",[f.required,f.minLength(8)]]},{validators:this.formValidatorService.passwordMatchValidator()})}otpEmail="";faEye=X;faEyeSlash=Q;isHiddenEye=!0;isHiddenCheckEye=!0;registerForm;toggleEye(){this.isHiddenEye=!this.isHiddenEye}toggleCheckEye(){this.isHiddenCheckEye=!this.isHiddenCheckEye}resetPassword(){if(this.registerForm.valid===!0){let i=this.registerForm.getRawValue(),e={email:this.otpEmail,password:i.password};this.userRepositoryService.putResetPassword(e).subscribe(r=>{this.sweetAlertService.open(W,{icon:r.result?"success":"error",data:{text:r.message}}).instance.afterClose.subscribe(()=>{r.result&&this.router.navigate(["/login"])})})}}static \u0275fac=function(e){return new(e||t)(l(I),l(T),l(h),l(E),l($))};static \u0275cmp=w({type:t,selectors:[["app-reset-password"]],inputs:{otpEmail:"otpEmail"},standalone:!0,features:[F],decls:24,vars:13,consts:[[1,"l-form"],[1,"l-form__title","l-form__title--login"],[1,"u-font-lg","u-tac"],[1,"l-form__content"],[1,"c-form","c-form--column",3,"formGroup"],[1,"c-form__item","c-form__item--column"],[1,"c-form__text"],[1,"c-login__input"],["formControlName","password","placeholder","\u8ACB\u8F38\u5165\u65B0\u5BC6\u78BC",1,"o-inputbox","o-inputbox--full","o-inputbox--icon",3,"type"],["href","#","appStopPropagation","",1,"c-login__eye",3,"click"],[1,"u-font-gy",3,"icon","size"],[4,"ngIf"],["formControlName","checkPassword","placeholder","\u78BA\u8A8D\u65B0\u5BC6\u78BC",1,"o-inputbox","o-inputbox--full","o-inputbox--icon",3,"type"],[1,"l-btn","l-btn--center","u-gapB-sm"],[1,"l-btn__item","l-btn__item--full"],["href","#","appStopPropagation","",1,"c-btn",3,"click"],["class","c-form__error",4,"ngIf"],[1,"c-form__error"]],template:function(e,r){e&1&&(s(0,"div",0)(1,"div",1)(2,"div",2),m(3,"\u91CD\u8A2D\u5BC6\u78BC"),a()(),s(4,"div",3)(5,"div",4)(6,"div",5)(7,"div",6)(8,"div",7),u(9,"input",8),s(10,"a",9),_("click",function(){return r.toggleEye()}),u(11,"fa-icon",10),a()()(),d(12,de,4,3,"ng-container",11),a(),s(13,"div",5)(14,"div",6)(15,"div",7),u(16,"input",12),s(17,"a",9),_("click",function(){return r.toggleCheckEye()}),u(18,"fa-icon",10),a()()(),d(19,ge,4,3,"ng-container",11),a()(),s(20,"div",13)(21,"div",14)(22,"a",15),_("click",function(){return r.resetPassword()}),m(23," \u9001\u51FA "),a()()()()()),e&2&&(n(5),o("formGroup",r.registerForm),n(4),g("is-error",r.registerForm.controls.password.invalid&&r.registerForm.controls.password.dirty),o("type",r.isHiddenEye?"password":"text"),n(2),o("icon",r.isHiddenEye?r.faEyeSlash:r.faEye)("size","lg"),n(),o("ngIf",r.registerForm.controls.password.dirty),n(4),g("is-error",r.registerForm.controls.checkPassword.invalid&&r.registerForm.controls.checkPassword.dirty),o("type",r.isHiddenCheckEye?"password":"text"),n(2),o("icon",r.isHiddenCheckEye?r.faEyeSlash:r.faEye)("size","lg"),n(),o("ngIf",r.registerForm.controls.checkPassword.dirty))},dependencies:[S,y,A,b,P,B,V,x,R,L,K,J,k]})};var ve=t=>({"background-image":t});function Ce(t,i){t&1&&(s(0,"div",20),m(1," \u8ACB\u8F38\u5165\u4FE1\u7BB1 "),a())}function we(t,i){t&1&&(s(0,"div",20),m(1," \u8ACB\u8F38\u5165\u6B63\u78BAemail\u683C\u5F0F "),a())}function Fe(t,i){if(t&1&&(v(0),d(1,Ce,2,0,"div",19)(2,we,2,0,"div",19),C()),t&2){let e=p(2);n(),o("ngIf",e.forgetForm.controls.email.hasError("required")&&e.forgetForm.controls.email.dirty),n(),o("ngIf",e.forgetForm.controls.email.hasError("pattern")&&e.forgetForm.controls.email.dirty)}}function ye(t,i){if(t&1){let e=H();s(0,"div")(1,"div",7)(2,"div",8)(3,"div",9),m(4,"\u5FD8\u8A18\u5BC6\u78BC"),a()(),s(5,"div",10)(6,"div",11)(7,"div",12)(8,"div",13),u(9,"input",14),a(),d(10,Fe,3,2,"ng-container",15),a()(),s(11,"div",16)(12,"div",17)(13,"a",18),_("click",function(){G(e);let c=p();return j(c.validEmail())}),m(14," \u9001\u51FA "),a()()()()()()}if(t&2){let e=p();n(6),o("formGroup",e.forgetForm),n(3),g("is-error",e.forgetForm.controls.email.invalid&&e.forgetForm.controls.email.dirty),n(),o("ngIf",e.forgetForm.controls.email.dirty)}}function Se(t,i){if(t&1){let e=H();s(0,"app-otp-valid",21),_("emitValidOtp",function(c){G(e);let N=p();return j(N.emitValidOtp(c))}),a()}if(t&2){let e=p();o("otpEmail",e.otpEmail)}}function he(t,i){if(t&1&&u(0,"app-reset-password",22),t&2){let e=p();o("otpEmail",e.otpEmail)}}var te=class t{constructor(i,e,r,c,N){this.fb=i;this.formValidatorService=e;this.router=r;this.userRepositoryService=c;this.tmdbRepositoryService=N;this.forgetForm=this.fb.group({email:["",{validators:[f.required,f.pattern("^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}$")]}]})}forgetForm;currentStep="email";bgPic="";get otpEmail(){return this.forgetForm.get("email")?.value}ngOnInit(){return M(this,null,function*(){let i=yield this.getMovieDetail();this.bgPic=i.backdrop_path})}validEmail(){if(this.forgetForm.valid===!0){let i=this.forgetForm.getRawValue();this.userRepositoryService.postSendMail({email:i.email}).subscribe(e=>{e.result===!0&&(this.currentStep="otp")})}}emitValidOtp(i){i===!0&&(this.currentStep="resetPassword")}getMovieDetail(){return M(this,null,function*(){let i={language:"zh-TW"};return yield O(this.tmdbRepositoryService.getMovieDetail("1104845",i))})}static \u0275fac=function(e){return new(e||t)(l(I),l(T),l(h),l(E),l(Y))};static \u0275cmp=w({type:t,selectors:[["app-forget-password"]],standalone:!0,features:[F],decls:7,vars:7,consts:[[1,"l-login","l-login--register",3,"ngStyle"],[1,"l-login__content"],[1,"l-login__item"],[3,"ngSwitch"],[4,"ngSwitchCase"],[3,"otpEmail","emitValidOtp",4,"ngSwitchCase"],[3,"otpEmail",4,"ngSwitchCase"],[1,"l-form"],[1,"l-form__title","l-form__title--login"],[1,"u-font-lg","u-tac"],[1,"l-form__content"],[1,"c-form","c-form--column",3,"formGroup"],[1,"c-form__item","c-form__item--column"],[1,"c-form__text"],["type","text","formControlName","email","placeholder","\u8ACB\u8F38\u5165\u4FE1\u7BB1",1,"o-inputbox","o-inputbox--full"],[4,"ngIf"],[1,"l-btn","l-btn--center","u-gapB-sm"],[1,"l-btn__item","l-btn__item--full"],["href","#","appStopPropagation","",1,"c-btn",3,"click"],["class","c-form__error",4,"ngIf"],[1,"c-form__error"],[3,"emitValidOtp","otpEmail"],[3,"otpEmail"]],template:function(e,r){e&1&&(s(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),d(4,ye,15,4,"div",4)(5,Se,1,1,"app-otp-valid",5)(6,he,1,1,"app-reset-password",6),a()()()()),e&2&&(o("ngStyle",z(5,ve,"url(https://image.tmdb.org/t/p/original"+r.bgPic+")")),n(3),o("ngSwitch",r.currentStep),n(),o("ngSwitchCase","email"),n(),o("ngSwitchCase","otp"),n(),o("ngSwitchCase","resetPassword"))},dependencies:[S,y,Z,q,U,A,b,P,B,V,x,R,k,ee,D]})};export{te as ForgetPasswordComponent};
