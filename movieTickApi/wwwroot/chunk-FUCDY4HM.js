import{a as $}from"./chunk-XL4GSPIQ.js";import{a as J}from"./chunk-VNO6BBWT.js";import{a as Q}from"./chunk-NO2D6GZT.js";import"./chunk-QXZLALXF.js";import{a as H}from"./chunk-XTBM2PFI.js";import"./chunk-22DMWHJU.js";import{c as D,d as V,e as N,h as O,j,o as G,p as Y,q as z}from"./chunk-3LHWI2W3.js";import"./chunk-IX7WFBWE.js";import"./chunk-2F6OI5QL.js";import{a as K}from"./chunk-AN255T3T.js";import{e as w,g as I,h as k,l as R}from"./chunk-Q7SBYYKA.js";import{a as W}from"./chunk-AN7I7KN4.js";import{c as q}from"./chunk-7ABVTXG4.js";import"./chunk-4QTMHVTB.js";import{$a as r,Ab as p,Ac as B,Bb as _,Ec as x,Jb as s,Lb as f,Rb as A,Tb as F,ab as l,ma as E,nb as u,qb as m,rb as b,sb as a,tb as o,ub as M,vb as h,wa as S,wb as C,wc as T,xa as y,xc as P,yb as L}from"./chunk-K24PMR7C.js";import"./chunk-TSRGIXR5.js";var X=e=>({"background-image":e}),Z=e=>["/ticketing",e];function ee(e,i){e&1&&(a(0,"div",24),s(1," \u8ACB\u8F38\u5165\u8D77\u59CB\u65E5 "),o())}function te(e,i){e&1&&(a(0,"div",24),s(1," \u8ACB\u8F38\u5165\u6B63\u78BA\u65E5\u671F\u683C\u5F0F "),o())}function ie(e,i){e&1&&(a(0,"div",24),s(1," \u8D77\u59CB\u65E5\u9700\u5C0F\u65BC\u7ED3\u675F\u65E5 "),o())}function re(e,i){if(e&1&&(h(0),u(1,ee,2,0,"div",23)(2,te,2,0,"div",23)(3,ie,2,0,"div",23),C()),e&2){let t=_();r(),m("ngIf",t.searchForm.controls.startDate.hasError("required")),r(),m("ngIf",t.searchForm.controls.startDate.hasError("invalidDate")),r(),m("ngIf",t.searchForm.controls.startDate.hasError("startDateAfterEndDate"))}}function oe(e,i){e&1&&(a(0,"div",24),s(1," \u8ACB\u8F38\u5165\u7D50\u675F\u65E5 "),o())}function ne(e,i){e&1&&(a(0,"div",24),s(1," \u8ACB\u8F38\u5165\u6B63\u78BA\u65E5\u671F\u683C\u5F0F "),o())}function ae(e,i){e&1&&(a(0,"div",24),s(1," \u7ED3\u675F\u65E5\u9700\u5927\u65BC\u8D77\u59CB\u65E5 "),o())}function me(e,i){if(e&1&&(h(0),u(1,oe,2,0,"div",23)(2,ne,2,0,"div",23)(3,ae,2,0,"div",23),C()),e&2){let t=_();r(),m("ngIf",t.searchForm.controls.endDate.hasError("required")),r(),m("ngIf",t.searchForm.controls.endDate.hasError("invalidDate")),r(),m("ngIf",t.searchForm.controls.endDate.hasError("startDateAfterEndDate"))}}function se(e,i){if(e&1){let t=L();a(0,"div",25)(1,"div",26)(2,"div",27)(3,"a",28),p("click",function(){let c=S(t).$implicit,d=_();return y(d.openLightbox(c.id))}),M(4,"div",29),o()(),a(5,"div",30)(6,"div",31),s(7),o(),a(8,"div",32),s(9),o(),a(10,"div",33),s(11),o()(),a(12,"a",34),s(13,"\u7DDA\u4E0A\u8A02\u7968"),o()()()}if(e&2){let t=i.$implicit;r(4),m("ngStyle",F(5,X,"url(https://image.tmdb.org/t/p/w342"+t.poster_path+")")),r(3),f(" ",t.title," "),r(2),f(" ",t.overview," "),r(2),f("\u4E0A\u6620\u65E5\u671F\uFF1A",t.release_date,""),r(),m("routerLink",F(7,Z,t.id))}}var U=class e{constructor(i,t,n,c,d,g){this.tmdbRepositoryService=i;this.formValidatorService=t;this.sweetAlertService=n;this.router=c;this.route=d;this.fb=g;this.sub=this.route.queryParams.subscribe(v=>{this.nowPage=parseInt(v.page,10)||1,this.getAllMovieList(this.nowPage,v.startDate,v.endDate,v.genres)}),this.searchForm=this.fb.group({startDate:["",D.required],endDate:["",D.required]},{validators:this.formValidatorService.dateRangeValidator()})}searchForm;sub;movieList=[];total=0;nowPage=1;localeConfig={format:"YYYY-MM-DD"};lightboxOptions={zoomable:!0};ngOnDestroy(){this.sub.unsubscribe()}submitForm(){if(this.searchForm.valid){let i=this.searchForm.getRawValue();this.router.navigate(["./"],{relativeTo:this.route,queryParams:{startDate:i.startDate,endDate:i.endDate,genres:this.route.snapshot.queryParams.genres||"",page:1}})}}formTouch(){this.searchForm.controls.endDate.markAsTouched(),this.searchForm.controls.startDate.markAsTouched()}getAllMovieList(i=1,t,n,c=""){let d={language:"zh-TW",sort_by:"popularity.desc","primary_release_date.gte":t||"","primary_release_date.lte":n||"",with_genres:c,page:i};this.tmdbRepositoryService.getMovieList(d).subscribe(g=>{this.total=g.total_pages,this.movieList=g.results})}changePageEmitter(i){this.nowPage=i,this.router.navigate(["./"],{relativeTo:this.route,queryParams:{startDate:this.route.snapshot.queryParams.startDate||"",endDate:this.route.snapshot.queryParams.endDate||"",genres:this.route.snapshot.queryParams.genres||"",page:i}})}openLightbox(i){this.sweetAlertService.open(Q,{data:{id:i}})}static \u0275fac=function(t){return new(t||e)(l(K),l(H),l(q),l(I),l(w),l(G))};static \u0275cmp=E({type:e,selectors:[["app-movie-list"]],standalone:!0,features:[A],decls:29,vars:12,consts:[[1,"l-headingBar"],[1,"l-headingBar__wrap"],[1,"l-headingBar__content"],[1,"l-headingBar__title"],[1,"l-movie"],[1,"l-movie__item"],[1,"l-movie__header"],[1,"l-form"],[1,"c-form","c-form--row"],[1,"c-form","u-gapT-sm",3,"formGroup"],[1,"c-form__item"],[1,"c-form__require"],[1,"c-form__text"],["formControlName","startDate",3,"input","isError","placeholder"],[4,"ngIf"],["formControlName","endDate",3,"input","isError","placeholder"],[1,"c-form__action"],["href","#","appStopPropagation","",1,"c-btn","c-btn--fullMb",3,"click"],[1,"l-movie__content"],[1,"l-movieCard"],[1,"l-movieCard__wrap"],["class","l-movieCard__itme l-movieCard__itme--sm",4,"ngFor","ngForOf"],[3,"changePageEmitter","total","nowPage"],["class","c-form__error",4,"ngIf"],[1,"c-form__error"],[1,"l-movieCard__itme","l-movieCard__itme--sm"],[1,"c-movieCard","c-movieCard--column","c-movieCard--zoom"],[1,"c-movieCard__head"],["href","#","appStopPropagation","",1,"o-link",3,"click"],[1,"c-movieCard__img",3,"ngStyle"],[1,"c-movieCard__content","c-movieCard__content--gary"],[1,"c-movieCard__title"],[1,"c-movieCard__subTitle"],[1,"c-movieCard__date"],["appStopPropagation","",1,"c-btn","c-btn--gap",3,"routerLink"]],template:function(t,n){t&1&&(a(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),s(4,"\u73FE\u6B63\u71B1\u6620"),o()()()(),a(5,"div",4)(6,"div",5)(7,"div",6)(8,"div",7)(9,"div",8)(10,"div",9)(11,"div",10)(12,"div",11)(13,"div",12)(14,"app-date-picker",13),p("input",function(){return n.formTouch()}),o()(),u(15,re,4,3,"ng-container",14),o()(),a(16,"div",10)(17,"div",11)(18,"div",12)(19,"app-date-picker",15),p("input",function(){return n.formTouch()}),o()(),u(20,me,4,3,"ng-container",14),o()(),a(21,"div",16)(22,"a",17),p("click",function(){return n.submitForm()}),s(23,"\u9001\u51FA"),o()()()()()(),a(24,"div",18)(25,"div",19)(26,"div",20),u(27,se,14,9,"div",21),o()()()()(),a(28,"app-pager",22),p("changePageEmitter",function(d){return n.changePageEmitter(d)}),o()),t&2&&(r(10),m("formGroup",n.searchForm),r(4),m("isError",n.searchForm.controls.startDate.invalid&&n.searchForm.controls.startDate.dirty)("placeholder","\u8ACB\u8F38\u5165\u8D77\u59CB\u65E5"),r(),m("ngIf",n.searchForm.controls.startDate.dirty),r(4),m("isError",n.searchForm.controls.endDate.invalid&&n.searchForm.controls.endDate.dirty)("placeholder","\u8ACB\u8F38\u5165\u7D50\u675F\u65E5"),r(),m("ngIf",n.searchForm.controls.endDate.dirty),r(2),b("is-disabled",n.searchForm.invalid),r(5),m("ngForOf",n.movieList),r(),m("total",n.total)("nowPage",n.nowPage))},dependencies:[x,T,P,B,Y,V,N,R,k,z,O,j,W,J,$]})};export{U as MovieListComponent};
