import{a as $}from"./chunk-VNO6BBWT.js";import{a as q}from"./chunk-OTZGEOSQ.js";import{a as H}from"./chunk-H67EF6UW.js";import"./chunk-3LHWI2W3.js";import{a as V}from"./chunk-WWFXL6JD.js";import{t as R}from"./chunk-TDJR5REH.js";import{a as M,b as O,c as U,f as j,j as Y}from"./chunk-MOQSDQEH.js";import{e as D,g as N}from"./chunk-KQUYMQJB.js";import{a as z}from"./chunk-AN7I7KN4.js";import{c as B}from"./chunk-AKLULRCC.js";import"./chunk-4QTMHVTB.js";import{$a as a,Ab as h,Bb as s,Dc as L,Ec as F,Ib as E,Jb as r,Kb as d,Mb as C,Rb as P,Ub as y,Wb as I,Xb as T,ab as u,ma as v,nb as g,qb as m,sb as i,tb as t,ub as p,vb as b,wa as f,wb as k,wc as w,xa as S,xc as A,yb as x}from"./chunk-K24PMR7C.js";import"./chunk-TSRGIXR5.js";function K(o,n){if(o&1){let e=x();i(0,"a",20),h("click",function(){f(e);let c=s().$implicit,_=s(2);return S(_.getPayPalLink(c.createOrderId))}),r(1,"\u9023\u7D50"),t()}}function Q(o,n){if(o&1&&(i(0,"tr")(1,"td",25)(2,"span"),r(3),t()(),i(4,"td",26)(5,"span"),r(6),t()(),i(7,"td",27)(8,"span"),r(9),t()(),p(10,"td",24)(11,"td",24)(12,"td",24),t()),o&2){let e=n.$implicit;a(3),d(e.ticketCategoryName),a(3),C("",e.ticketColumn,"\u6392",e.ticketSeat,"\u865F"),a(3),d(e.ticketMoney)}}function X(o,n){if(o&1&&(i(0,"tr",21)(1,"td",22)(2,"table",23)(3,"colgroup"),p(4,"col",3)(5,"col",4)(6,"col",5)(7,"col",6)(8,"col",4)(9,"col",6),t(),i(10,"thead")(11,"tr")(12,"th"),r(13,"\u7968\u7A2E"),t(),i(14,"th"),r(15,"\u5EA7\u4F4D"),t(),i(16,"th",7),r(17,"\u7968\u50F9"),t(),p(18,"th",24)(19,"th",24)(20,"th",24),t()(),i(21,"tbody"),g(22,Q,13,4,"tr",8),t()()()()),o&2){let e=s().$implicit;a(22),m("ngForOf",e.ticketPersonalItem)}}function Z(o,n){if(o&1){let e=x();i(0,"tbody")(1,"tr")(2,"td",10),r(3),t(),i(4,"td",11),r(5),t(),i(6,"td",12)(7,"span"),r(8),y(9,"date"),t()(),i(10,"td",13)(11,"span"),r(12),t()(),i(13,"td",14),g(14,K,2,0,"a",15),t(),i(15,"td",16)(16,"a",17),h("click",function(){let c=f(e).index,_=s(2);return S(_.toggleVisibility(c))}),p(17,"fa-icon",18),t()()(),g(18,X,23,1,"tr",19),t()}if(o&2){let e=n.$implicit,l=n.index,c=s(2);a(3),d(e.movieName),a(2),d(e.ticketLanguageName),a(3),d(I(9,7,e.ticketDate,"YYYY\u5E74MM\u6708dd\u65E5 HH:mm")),a(4),d(e.ticketStatusName),a(2),m("ngIf",e.ticketStatusId===2),a(3),m("icon",c.menuList[l]?c.faChevronUp:c.faChevronDown),a(),m("ngIf",c.menuList[l]===!0)}}function ee(o,n){if(o&1){let e=x();b(0),i(1,"table",2)(2,"colgroup"),p(3,"col",3)(4,"col",4)(5,"col",5)(6,"col",6)(7,"col",4)(8,"col",6),t(),i(9,"thead")(10,"tr")(11,"th"),r(12,"\u96FB\u5F71\u540D\u7A31"),t(),i(13,"th"),r(14,"\u8A9E\u8A00"),t(),i(15,"th",7),r(16,"\u6642\u9593"),t(),i(17,"th",7),r(18,"\u72C0\u614B"),t(),i(19,"th",7),r(20,"\u4ED8\u6B3E\u9023\u7D50"),t(),i(21,"th",7),r(22,"\u66F4\u591A"),t()()(),g(23,Z,19,10,"tbody",8),t(),i(24,"app-pager",9),h("changePageEmitter",function(c){f(e);let _=s();return S(_.changePageEmitter(c))}),t(),k()}if(o&2){let e=s();a(23),m("ngForOf",e.ticketPersonalList),a(),m("total",e.total)("nowPage",e.nowPage)}}function te(o,n){if(o&1&&(i(0,"div",28)(1,"div",29)(2,"div",30),p(3,"fa-icon",31),i(4,"p",32)(5,"span",33),r(6,"\u6C92\u6709\u8CC7\u6599"),t(),p(7,"br"),t()()()()),o&2){let e=s();a(3),m("icon",e.faFileAlt)("size","6x")}}var W=class o{constructor(n,e,l,c,_,ie){this.ticketRepositoryService=n;this.userStoreService=e;this.sweetAlertService=l;this.router=c;this.route=_;this.loaderService=ie;this.sub=this.route.queryParams.subscribe(G=>{if(this.userNo===0)return;this.nowPage=parseInt(G.page,10)||1;let J={userNo:this.userNo,pageIndex:this.nowPage,pageSize:this.pageSize};this.getPersonalTicketList(J)})}faChevronDown=Y;faChevronUp=j;faFileAlt=U;userNo=0;total=0;nowPage=1;pageSize=10;sub;ticketPersonalList=[];menuList=[];ngOnInit(){this.userStoreService.getUserData().subscribe(n=>{if(n!==null&&n.userNo!==0){this.userNo=n.userNo;let e={userNo:this.userNo,pageIndex:this.nowPage,pageSize:this.pageSize};this.getPersonalTicketList(e)}})}getPersonalTicketList(n){this.ticketRepositoryService.getPersonalTicketList(n).subscribe(e=>{this.menuList=e.result.result.map(l=>!l),this.ticketPersonalList=e.result.result,this.total=e.result.totalPage,this.nowPage=e.result.pageIndex,this.pageSize=e.result.pageSize})}toggleVisibility(n){this.menuList=this.menuList.map((e,l)=>l===n?!e:!1)}getPayPalLink(n){this.ticketRepositoryService.getOrderLink({orderId:n}).subscribe(e=>{e.result!==null?(window.location.href=e.result,this.loaderService.startLoadingCount()):this.sweetAlertService.open(V,{icon:"error",data:{text:e.message}})})}changePageEmitter(n){this.nowPage=n,this.router.navigate(["./"],{relativeTo:this.route,queryParams:{page:n}})}static \u0275fac=function(e){return new(e||o)(u(q),u(R),u(B),u(N),u(D),u(H))};static \u0275cmp=v({type:o,selectors:[["app-ticket"]],standalone:!0,features:[P],decls:3,vars:2,consts:[["noData",""],[4,"ngIf","ngIfElse"],[1,"c-table","c-table--card","c-table--collapse"],[2,"width","200px"],[2,"width","100px"],[2,"width","180px"],[2,"width","130px"],[1,"is-center"],[4,"ngFor","ngForOf"],[3,"changePageEmitter","total","nowPage"],["data-label","\u96FB\u5F71\u540D\u7A31"],["data-label","\u8A9E\u8A00"],["data-label","\u6642\u9593",1,"is-center"],["data-label","\u72C0\u614B",1,"is-center"],["data-label","\u4ED8\u6B3E\u9023\u7D50",1,"is-center"],["href","#","appStopPropagation","","class","c-btn",3,"click",4,"ngIf"],["data-label","\u66F4\u591A",1,"is-center"],["href","#","appStopPropagation","",1,"o-link","o-link--primary",3,"click"],[3,"icon"],["class","c-table__accordionWrap",4,"ngIf"],["href","#","appStopPropagation","",1,"c-btn",3,"click"],[1,"c-table__accordionWrap"],["colspan","6",1,"c-table__accordion"],[1,"c-table","c-table--card"],[1,"u-hidden"],["data-label","\u7968\u7A2E"],["data-label","\u5EA7\u4F4D"],["data-label","\u7968\u50F9",1,"is-center"],[1,"l-card"],[1,"l-card__content"],[1,"o-statusBox"],[1,"o-statusBox__img",3,"icon","size"],[1,"o-statusBox__msg"],[1,"u-font-lg"]],template:function(e,l){if(e&1&&g(0,ee,25,3,"ng-container",1)(1,te,8,2,"ng-template",null,0,T),e&2){let c=E(2);m("ngIf",l.total>0)("ngIfElse",c)}},dependencies:[F,w,A,L,O,M,$,z]})};export{W as TicketComponent};
