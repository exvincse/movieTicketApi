import{a as Y}from"./chunk-XL4GSPIQ.js";import{a as W}from"./chunk-VNO6BBWT.js";import{a as J}from"./chunk-AFPS7HJU.js";import"./chunk-QXZLALXF.js";import{a as $}from"./chunk-5QC76IQF.js";import"./chunk-22DMWHJU.js";import{c as g,d as q,e as V,h as N,j as O,o as x,p as j,q as G}from"./chunk-3LHWI2W3.js";import"./chunk-IUYBZPAI.js";import"./chunk-TDJR5REH.js";import{a as H}from"./chunk-AN255T3T.js";import{e as B,g as w,h as I,k}from"./chunk-KQUYMQJB.js";import{a as z}from"./chunk-AN7I7KN4.js";import{c as R}from"./chunk-AKLULRCC.js";import"./chunk-4QTMHVTB.js";import{$a as o,Ab as c,Ac as P,Bb as y,Ec as T,Jb as s,Lb as _,Rb as A,Tb as h,ab as u,ma as F,nb as v,qb as m,rb as E,sb as a,tb as r,ub as S,wa as C,wc as M,xa as D,xc as L,yb as b}from"./chunk-K24PMR7C.js";import"./chunk-TSRGIXR5.js";var Q=t=>({"background-image":t}),U=t=>["/ticketing",t];function X(t,i){t&1&&(a(0,"div",23),s(1," \u8ACB\u8F38\u5165\u8D77\u59CB\u65E5 "),r())}function Z(t,i){t&1&&(a(0,"div",23),s(1," \u8ACB\u8F38\u5165\u6B63\u78BA\u65E5\u671F\u683C\u5F0F "),r())}function ee(t,i){t&1&&(a(0,"div",23),s(1," \u8D77\u59CB\u65E5\u9700\u5C0F\u65BC\u7ED3\u675F\u65E5 "),r())}function te(t,i){t&1&&(a(0,"div",23),s(1," \u8ACB\u8F38\u5165\u7D50\u675F\u65E5 "),r())}function ie(t,i){t&1&&(a(0,"div",23),s(1," \u8ACB\u8F38\u5165\u6B63\u78BA\u65E5\u671F\u683C\u5F0F "),r())}function re(t,i){t&1&&(a(0,"div",23),s(1," \u7ED3\u675F\u65E5\u9700\u5927\u65BC\u8D77\u59CB\u65E5 "),r())}function oe(t,i){if(t&1){let n=b();a(0,"div",24)(1,"div",25)(2,"a",26),c("click",function(){let l=C(n).$implicit,d=y();return D(d.openLightbox(l.id))}),S(3,"div",27),r(),a(4,"div",28)(5,"div",29),s(6),r(),a(7,"div",30),s(8),r(),a(9,"div",31),s(10),r()(),a(11,"a",32),s(12,"\u7DDA\u4E0A\u8A02\u7968"),r()()()}if(t&2){let n=i.$implicit;o(3),m("ngStyle",h(5,Q,"url(https://image.tmdb.org/t/p/w342"+n.poster_path+")")),o(3),_(" ",n.title," "),o(2),_(" ",n.overview," "),o(2),_("\u4E0A\u6620\u65E5\u671F\uFF1A",n.release_date,""),o(),m("routerLink",h(7,U,n.id))}}var K=class t{constructor(i,n,e,l,d,f){this.tmdbRepositoryService=i;this.formValidatorService=n;this.sweetAlertService=e;this.router=l;this.route=d;this.fb=f;this.sub=this.route.queryParams.subscribe(p=>{this.nowPage=parseInt(p.page,10)||1,this.getAllMovieList(this.nowPage,p.startDate,p.endDate,p.genres)}),this.searchForm=this.fb.group({startDate:["",g.required],endDate:["",g.required]},{validators:this.formValidatorService.dateRangeValidator()})}searchForm;sub;movieList=[];total=0;nowPage=1;localeConfig={format:"YYYY-MM-DD"};lightboxOptions={zoomable:!0};ngOnInit(){this.getAllMovieList()}ngOnDestroy(){this.sub.unsubscribe()}submitForm(){if(this.searchForm.valid){let i=this.searchForm.getRawValue();this.router.navigate(["./"],{relativeTo:this.route,queryParams:{startDate:i.startDate,endDate:i.endDate,genres:this.route.snapshot.queryParams.genres||"",page:1}})}}formTouch(){this.searchForm.controls.endDate.markAsTouched(),this.searchForm.controls.startDate.markAsTouched()}getAllMovieList(i=1,n,e,l=""){let d={language:"zh-TW",sort_by:"popularity.desc","primary_release_date.gte":n||"","primary_release_date.lte":e||"",with_genres:l,page:i};this.tmdbRepositoryService.getMovieList(d).subscribe(f=>{this.total=f.total_results,this.movieList=f.results})}changePageEmitter(i){this.nowPage=i,this.router.navigate(["./"],{relativeTo:this.route,queryParams:{startDate:this.route.snapshot.queryParams.startDate||"",endDate:this.route.snapshot.queryParams.endDate||"",genres:this.route.snapshot.queryParams.genres||"",page:i}})}openLightbox(i){this.sweetAlertService.open(J,{data:{id:i}})}static \u0275fac=function(n){return new(n||t)(u(H),u($),u(R),u(w),u(B),u(x))};static \u0275cmp=F({type:t,selectors:[["app-movie-list"]],standalone:!0,features:[A],decls:33,vars:16,consts:[[1,"l-headingBar"],[1,"l-headingBar__wrap"],[1,"l-headingBar__content"],[1,"l-headingBar__title"],[1,"l-movie"],[1,"l-movie__item"],[1,"l-movie__header"],[1,"l-form"],[1,"c-form","c-form--row"],[1,"c-form","u-gapT-sm",3,"formGroup"],[1,"c-form__item"],[1,"c-form__require"],[1,"c-form__text"],["formControlName","startDate",3,"input","isError","placeholder"],["class","c-form__error",4,"ngIf"],["formControlName","endDate",3,"input","isError","placeholder"],[1,"c-form__action"],["href","#","appStopPropagation","",1,"c-btn","c-btn--fullMb",3,"click"],[1,"l-movie__content"],[1,"l-movieCard"],[1,"l-movieCard__wrap"],["class","l-movieCard__itme l-movieCard__itme--sm",4,"ngFor","ngForOf"],[3,"changePageEmitter","total","nowPage"],[1,"c-form__error"],[1,"l-movieCard__itme","l-movieCard__itme--sm"],[1,"c-movieCard","c-movieCard--column","c-movieCard--zoom"],["href","#","appStopPropagation","",1,"o-link",3,"click"],[1,"c-movieCard__img",3,"ngStyle"],[1,"c-movieCard__content","c-movieCard__content--gary"],[1,"c-movieCard__title"],[1,"c-movieCard__subTitle"],[1,"c-movieCard__date"],["appStopPropagation","",1,"c-btn","c-btn--gap",3,"routerLink"]],template:function(n,e){n&1&&(a(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),s(4,"\u73FE\u6B63\u71B1\u6620"),r()()()(),a(5,"div",4)(6,"div",5)(7,"div",6)(8,"div",7)(9,"div",8)(10,"div",9)(11,"div",10)(12,"div",11)(13,"div",12)(14,"app-date-picker",13),c("input",function(){return e.formTouch()}),r()(),v(15,X,2,0,"div",14)(16,Z,2,0,"div",14)(17,ee,2,0,"div",14),r()(),a(18,"div",10)(19,"div",11)(20,"div",12)(21,"app-date-picker",15),c("input",function(){return e.formTouch()}),r()(),v(22,te,2,0,"div",14)(23,ie,2,0,"div",14)(24,re,2,0,"div",14),r()(),a(25,"div",16)(26,"a",17),c("click",function(){return e.submitForm()}),s(27,"\u9001\u51FA"),r()()()()()(),a(28,"div",18)(29,"div",19)(30,"div",20),v(31,oe,13,9,"div",21),r()()()()(),a(32,"app-pager",22),c("changePageEmitter",function(d){return e.changePageEmitter(d)}),r()),n&2&&(o(10),m("formGroup",e.searchForm),o(4),m("isError",!e.searchForm.controls.startDate.valid&&e.searchForm.controls.startDate.touched)("placeholder","\u8ACB\u8F38\u5165\u8D77\u59CB\u65E5"),o(),m("ngIf",e.searchForm.controls.startDate.hasError("required")&&e.searchForm.controls.startDate.touched),o(),m("ngIf",e.searchForm.controls.startDate.hasError("invalidDate")),o(),m("ngIf",e.searchForm.controls.startDate.hasError("startDateAfterEndDate")),o(4),m("isError",!e.searchForm.controls.endDate.valid&&e.searchForm.controls.endDate.touched)("placeholder","\u8ACB\u8F38\u5165\u7D50\u675F\u65E5"),o(),m("ngIf",e.searchForm.controls.endDate.hasError("required")&&e.searchForm.controls.endDate.touched),o(),m("ngIf",e.searchForm.controls.endDate.hasError("invalidDate")),o(),m("ngIf",e.searchForm.controls.endDate.hasError("startDateAfterEndDate")),o(2),E("is-disabled",e.searchForm.invalid),o(5),m("ngForOf",e.movieList),o(),m("total",e.total)("nowPage",e.nowPage))},dependencies:[T,M,L,P,j,q,V,k,I,G,N,O,z,W,Y]})};export{K as MovieListComponent};
